document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("counters"),t=document.getElementById("typeFilterCheckbox"),n=document.getElementById("columnSelect"),o=document.getElementById("filterSelect");let l=[];const c=localStorage.getItem("filterValue")||"alphabetical",a="true"===localStorage.getItem("typeFilter"),r=localStorage.getItem("columnCount")||"1";function i(){localStorage.setItem("filterValue",o.value),localStorage.setItem("typeFilter",t.checked),localStorage.setItem("columnCount",n.value)}function s(){const e=nicknameInput.value.trim();e?(localStorage.setItem("userNickname",e),alert("닉네임이 저장되었습니다.")):alert("닉네임을 입력해주세요.")}function d(){const n=o.value,c=t.checked;i();let a=[...l];if(a.sort(((e,t)=>{switch(n){case"alphabetical":return e.label.localeCompare(t.label,"ko");case"count":return t.count-e.count;case"lastModified":return t.lastModified-e.lastModified;default:return 0}})),e.innerHTML="",c){const t=[...new Set(a.map((e=>e.type)))];t.sort(((e,t)=>"물딜"===e?-1:"물딜"===t?1:0)),t.forEach((t=>{const n=document.createElement("div");n.className="type-container",n.innerHTML=`<h2>${t}</h2>`;const o=document.createElement("div");o.className="counters-grid",a.filter((e=>e.type===t)).forEach((e=>e.appendTo(o))),n.appendChild(o),e.appendChild(n)}))}else{const t=document.createElement("div");t.className="counters-grid",a.forEach((e=>e.appendTo(t))),e.appendChild(t)}u()}function u(){const e=n.value;document.querySelectorAll(".counters-grid").forEach((t=>{t.style.gridTemplateColumns=`repeat(${e}, 1fr)`})),i()}o.value=c,t.checked=a,n.value=r,nicknameSaveButton.addEventListener("click",s),nicknameInput.addEventListener("keypress",(e=>{"Enter"===e.key&&s()})),function(){const e=localStorage.getItem("userNickname");e&&(nicknameInput.value=e)}(),e&&o&&t&&n?(counterConfigs.forEach((e=>{const t=new Counter(e);l.push(t)})),o.addEventListener("change",d),t.addEventListener("change",d),n.addEventListener("change",u),d()):console.error("필요한 HTML 요소를 찾을 수 없습니다.")}));const settingsButton=document.getElementById("settingsButton"),bottomRightControls=document.getElementById("bottom-right-controls");settingsButton.addEventListener("click",(()=>{bottomRightControls.classList.toggle("open")})),document.addEventListener("click",(e=>{bottomRightControls.contains(e.target)||e.target===settingsButton||bottomRightControls.classList.remove("open")}));const filterButton=document.getElementById("filterButton"),filterOptions=document.getElementById("filterOptions"),filterLabel=document.getElementById("filterLabel");filterButton.addEventListener("click",(()=>{filterOptions.style.display="none"===filterOptions.style.display?"block":"none"})),document.querySelectorAll(".filter-option").forEach((e=>{e.addEventListener("click",(function(){document.getElementById("filterLabel").textContent=this.textContent,document.getElementById("filterOptions").style.display="none",applyFilter()}))}));